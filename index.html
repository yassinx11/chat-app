<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Local Number Chat</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f2f2f2;
           display: flex; justify-content: center; align-items: center; height: 100vh; }
    #chat-app { width: 400px; background: white; border-radius: 12px;
                box-shadow: 0 4px 10px rgba(0,0,0,0.1); padding: 20px;
                display: flex; flex-direction: column; }
    #messages { flex: 1; overflow-y: auto; border: 1px solid #ddd;
                padding: 10px; margin-bottom: 10px; height: 300px; background: #fafafa; }
    #messages div { margin-bottom: 5px; }
    input, button { padding: 10px; margin: 2px 0; border-radius: 6px;
                    border: 1px solid #ccc; font-size: 14px; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
<div id="chat-app">
  <div>
    <label>Chat Number: </label>
    <input type="text" id="numberInput" />
    <button onclick="setChatNumber()">Join</button>
  </div>
  <div id="chat-number"></div>
  <div id="messages"></div>
  <div>
    <input type="text" id="msgInput" placeholder="Type a message..." style="width: 75%;">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<script>
let chatNumber = Math.floor(100000 + Math.random() * 900000).toString();

document.getElementById("numberInput").value = chatNumber;
setChatNumber();

function setChatNumber() {
  chatNumber = document.getElementById("numberInput").value.trim();
  document.getElementById("chat-number").innerText = "Connected to #" + chatNumber;
  loadMessages();
}

function loadMessages() {
  const data = JSON.parse(localStorage.getItem("chat_" + chatNumber) || "[]");
  renderMessages(data);
}

function renderMessages(msgs) {
  const msgBox = document.getElementById("messages");
  msgBox.innerHTML = "";
  msgs.forEach(line => {
    const div = document.createElement("div");
    div.textContent = line;
    msgBox.appendChild(div);
  });
  msgBox.scrollTop = msgBox.scrollHeight;
}

function sendMessage() {
  const msg = document.getElementById("msgInput").value.trim();
  if (!msg) return;
  const key = "chat_" + chatNumber;
  let data = JSON.parse(localStorage.getItem(key) || "[]");
  data.push(msg);
  localStorage.setItem(key, JSON.stringify(data));
  document.getElementById("msgInput").value = "";
  renderMessages(data);
}
</script>
</body>
</html>
